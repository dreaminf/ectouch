!function(a,b){b.categorylist={init:function(){this.searchUrl="http://s.m.taobao.com/search.htm",this.scm="1820.maincat.",this.lazyload=lib.lazyload({lazyHeight:100,lazyWidth:0,definition:!1,size:null,lazyClass:"lazy",adaptive:!0,autoDestroy:!1}),this.renderCateList(),this.createScroller(),this.pullDate(),this.addEvent(),this.checkLazyImg()},renderCateList:function(){var a=this,b=$(".cate-list"),c=window.cateNameList,d="";if(c){for(var e=0;e<c.length;e++){var f="";0==e&&(f="cur"),d+='<li><a class="'+f+'">'+c[e]+"</a></li>"}b.html(d)}$(".cate-item").first().removeClass("none"),a.calcImgSize()},addEvent:function(){var a=this,b=$(".cate-list a"),c=$(".cate-conts .cate-item"),d=$("#J-search-form"),e=$("#J-search-input"),f=$(".search-tip");if(b.length&&(b.on("tap",function(d){d.preventDefault();var e=d.currentTarget,f=b.index(e);b.removeClass("cur"),$(e).addClass("cur"),c.addClass("none").eq(f).removeClass("none"),a.calcImgSize(f),setTimeout(function(){a.cateContScroller.refresh(),a.cateContScroller.scrollTo(0),a.checkLazyImg()},10),a.cateListScroller&&a.cateListScroller.scrollToElement(e,!0),window.sessionStorage&&window.sessionStorage.setItem("h5_category_tabIndex",f);var g="tab"+parseInt(f+1),h=a.scm+g+".1";a.aplusLog(h)}),b.on("click",function(a){a.preventDefault()})),window.sessionStorage){var g=window.sessionStorage.getItem("h5_category_tabIndex");g&&b.eq(g).trigger("tap")}e.val()&&e.val().replace(/(^\s+)|(\s+$)/g,"")?f.hide():f.show(),d.on("tap",".search-tip",function(){f.hide(),e[0].focus()}),d.on("submit",function(b){b.preventDefault();var c=e.val().replace(/(^\s+)|(\s+$)/g,"");c&&(c=encodeURIComponent(c),e.val(""),location.href=a.searchUrl+"?q="+c+"&from=catlist")}),e.on("focus",function(){f.hide()}),e.on("blur",function(){e.val().replace(/(^\s+)|(\s+$)/g,"")||(e.val(""),f.show())}),$(".cate-conts").on("click","a",function(a){a.preventDefault();var b=$(a.currentTarget),c=b.attr("href");if(c){var d=new lib.httpurl(c);d.params.from="catlist",location.href=d.toString()}}),lib.env.taobaoApp&&(window.WindVane.call("WebAppInterface","enableStatusBarClicked","",null,null),document.addEventListener("TBStatusBar.clicked",function(){self.pageScroller.scrollTo(0,!0)},!1))},calcImgSize:function(a){a=a||0;var b=$(".cate-item").eq(a),c=b.find(".banner-ul"),d=b.find(".cate-item-sec-brand ul"),e=b.attr("data-isCalculated");"true"!=e&&(c.each(function(a,b){var c=$(b),d=c.find("li");2==d.length?d.css({width:"49%"}):1==d.length&&d.css("height",Math.floor(140*d.width()/452))}),d.each(function(a,b){var c=$(b),d=c.find("li");d.css("height",Math.floor(80*d.width()/140))}),b.attr("data-isCalculated","true"))},pullDate:function(){function a(a){var c={};a&&a.utdid&&(c.utdid=a.utdid),lib.mtop.request({api:"com.taobao.wireless.chanel.getHotCat",v:"1.0",data:c},function(a){if(-1!=a.ret[0].indexOf("SUCCESS::")){var c="",d="";if(a.data&&a.data.model.leafPrefer){var e=a.data.model.leafPrefer;for(key in a.data.model.topPrefer){d+='<div class="cate-item-sec"><p class="title">'+key+'</p><ul class="item-list-ul">';for(var f=0;f<a.data.model.topPrefer[key].length;f++)d+='<li><a href="'+a.data.model.topPrefer[key][f].searchUrl+'"><div class="pic"><img data-img="'+a.data.model.topPrefer[key][f].picUrl+'" class="lazy" src="http://gtms02.alicdn.com/tps/i2/T1scDRFShaXXc6Yc2r-1-1.gif"/></div><p class="name">'+a.data.model.topPrefer[key][f].catName+"</p></a></li>";d+="</ul></div>"}var g=e.length;c+='<div class="cate-item-sec"><p class="title">为您推荐</p><ul class="item-list-ul">';for(var h=0;g>h;h++)c+='<li><a href="'+e[h].searchUrl+'"><div class="pic"><img data-img="'+e[h].picUrl+'" class="lazy" src="http://gtms02.alicdn.com/tps/i2/T1scDRFShaXXc6Yc2r-1-1.gif"/></div><p class="name">'+e[h].catName+"</p></a></li>",(h+1)%3==0&&h+1!=g&&(c+='</ul><ul class="item-list-ul">');c+="</ul></div>",c+=d,$(".cate-recommended").html(c),setTimeout(function(){b.cateContScroller.refresh()},100)}}else $(".isHidden").css("display","block"),console.log(a)},function(a){$(".isHidden").css("display","block"),console.log(a)})}var b=this;window.WindVane&&lib.env.taobaoApp?window.WindVane.call("TBDeviceInfo","getUtdid",{},function(b){a(b)},function(a){console.log("failure: "+JSON.stringify(a))}):a()},createScroller:function(){var a=this,b=$(".cate-list"),c=$(".cate-conts"),d=$(".category-left"),e=b.find("li").last(),f=d[0].getBoundingClientRect(),g=e[0].getBoundingClientRect();a.cateContScroller=lib.scroll(c[0],{direction:"y",isPrevent:!0,bounceOffset:{top:0,bottom:0}}),a.cateContScroller.init(),a.cateContScroller.element.addEventListener("scrollend",function(){a.checkLazyImg()}),g.bottom-f.bottom>0?(a.cateListScroller=lib.scroll(b[0],{direction:"y",isPrevent:!0}),a.cateListScroller.init()):d.on("touchmove",function(a){a.preventDefault()})},checkLazyImg:function(){var a=this,b=$("img[data-img]");b.each(function(b,c){a.cateContScroller.isInView(c)&&(c.setAttribute("src",c.getAttribute("data-img")),c.removeAttribute("data-img")),c.classList.remove("lazy")})},aplusLog:function(a){window.goldlog&&goldlog.record("/wap.888.4","","maincat="+a,"H46717825")}},document.addEventListener("DOMContentLoaded",function(){b.categorylist.init()},!1)}(window,window.app||(window.app={}));